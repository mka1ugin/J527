# J527
## Дополнительный контроллер для подрулевого блока 5K0953569, реализующий работу кнопки ассистентов, круиза и обогрева руля

Руль от Skoda 2021 5E3419093CVKH оборудован обогревом руля, кнопкой включения и выключения подогрева, а также кнопками быстрого вызова ассистентов и установки скорости круиз-контроля. Руль дооснащён LIN-LIN конвертером https://github.com/mka1ugin/LIN_MFSW_Adapter и установлен на VW Passat B6.
Подрулевой блок 5K0953569T доработан путём установки дополнительных шлейфов обогрева руля от блока 5Q1953569B. 
Контроллер выполнен на МК STM32F103C8T6 и реализует следующие функции:
* Управление работой обогрева руля
* Эмуляция нажатия кнопки быстрого вызова ассистентов
* Эмуляция нажатия кнопки задания скорости круиз-контроля

## Контроль обогрева руля

Сигнал нажатия кнопки обогрева руля отслеживается через LIN-шину. Нажатие кнопки включает и выключает обогрев руля. Питание на обогрев подаётся с клеммы 15 и только при включенном зажигании. Кроме того, контроллер отслеживает напряжение питания и работа возможна только при напряжении выше 12.5 В (настраивается в прошивке), т.е. при работающем двигателе. Силовой ключ VN7010A взят из блока 5Q1953569B.
Контроллер оборудован FRAM-памятью FM24CL16, в которую записывается каждое изменение состояния обогрева. Таким образом, если машина была заглушена со включенным обогревом, при следующем запуске двигателя обогрев будет включен автоматически.

## Эмуляция нажатия кнопок

Контроллер управляет двумя герконовыми реле серии EDR3. Их контактные группы включены параллельно штатным кнопкам "SET" круиз-контроля и кнопке быстрого вызова ассистентов. Контакты геркона дублируют состояние соответствующих кнопок на руле.

## Реализация

Контроллер выполнен на односторонней плате размером 50x47.5 мм и соединяется с блоком подрулевых переключателей двумя разъёмами: трёхконтактный - питание 12В и LIN-шина, и пятиконтактный - эмуляция нажатия кнопок. Также контроллер имеет два силовых четырёхконтактных разъёма - вход силового питания и выход на шлейф обогрева.![render3](https://user-images.githubusercontent.com/62425725/213983193-2fed8cca-8de9-4eec-aa23-3877de5484ec.png)



## Видео работы:
<p align="center">
  <a href="https://youtu.be/Oqg4uzVC5qI"><img width="600"
 src="https://user-images.githubusercontent.com/62425725/213980667-140c1767-461a-4557-b38d-d9d5b94dc090.jpg" alt="youtube">
</p>

